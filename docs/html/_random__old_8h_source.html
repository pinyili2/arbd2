<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ARBD2 C++ Library: src/Random_old.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ARBD2 C++ Library
   </div>
   <div id="projectbrief">Atomic Resolution Brownian Dynamics v2</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_random__old_8h_source.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Random_old.h</div></div>
</div><!--header-->
<div class="contents">
<a href="_random__old_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span> </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &quot;<a class="code" href="_g_p_u_manager_8h.html">GPUManager.h</a>&quot;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &quot;<a class="code" href="_types_8h.html">Types.h</a>&quot;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &quot;<a class="code" href="_proxy_8h.html">Proxy.h</a>&quot;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;cuda.h&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;cuda_runtime.h&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;curand_kernel.h&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;curand.h&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;mutex&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#define cuRandchk(ans) { cuRandAssert((ans), __FILE__, __LINE__); }</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="keyword">inline</span> <span class="keywordtype">void</span> cuRandAssert(curandStatus code, <span class="keyword">const</span> <span class="keywordtype">char</span> *file, <span class="keywordtype">int</span> line, <span class="keywordtype">bool</span> abort=<span class="keyword">true</span>) {</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    <span class="keywordflow">if</span> (code != CURAND_STATUS_SUCCESS) {</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>        fprintf(stderr, <span class="stringliteral">&quot;CURAND Error: %d (%s:%d)\n&quot;</span>, code, file, line);</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>        <span class="keywordflow">if</span> (abort) exit(code);</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    }</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>}</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="comment">// Q: What does the &quot;front end&quot; host interface to Random need to have?</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="comment">// A:   A way to fetch and restore the state of the backend. Could also have functions for retrieving values, but these would not be used in most of our code, because we need something that works regardless of whether it&#39;s living on host or device</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keyword">class </span>RandomBackend;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt; <span class="keyword">class </span><a class="code hl_class" href="class_random_c_p_u.html">RandomCPU</a>;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt; <span class="keyword">class </span>RandomGPU;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span> </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="comment">// class RandomBackend {</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="comment">//     // TBD</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="comment">// };</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="comment">// class RandomBackendGPU : RandomBackend {};</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="comment">// END Oct2024</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span> </div>
<div class="foldopen" id="foldopen00045" data-start="{" data-end="}">
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno"><a class="line" href="namespace_random.html">   45</a></span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_random.html">Random</a> {</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <span class="comment">// Interface</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> RNG&gt;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno"><a class="line" href="namespace_random.html#a4f13e6f3e1a58cffdfc1a5bfc199066f">   49</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keyword">typename</span> RNG::state_t* <a class="code hl_function" href="namespace_random.html#a4f13e6f3e1a58cffdfc1a5bfc199066f">get_gaussian_state</a>(RNG* random);</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> RNG&gt;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno"><a class="line" href="namespace_random.html#a92140ec7ba37826f5685b5dec6929cf3">   52</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_random.html#a92140ec7ba37826f5685b5dec6929cf3">set_gaussian_state</a>(RNG* random, <span class="keyword">typename</span> RNG::state_t* state);</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> RNG&gt;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno"><a class="line" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">   55</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(RNG* random, <span class="keyword">typename</span> RNG::state_t* state = <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    <span class="comment">// Host-only implementations for RandomCPU</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt;</div>
<div class="foldopen" id="foldopen00059" data-start="{" data-end="}">
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno"><a class="line" href="namespace_random.html#ab7ba71f0ac4249dfc8f988ff06d0d499">   59</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <span class="keyword">inline</span> <span class="keyword">typename</span> <a class="code hl_typedef" href="class_random_c_p_u.html#a07c21897e0ae43da2997906d82f9e3b7">RandomCPU&lt;num_states&gt;::state_t</a>* <a class="code hl_function" href="namespace_random.html#a4f13e6f3e1a58cffdfc1a5bfc199066f">get_gaussian_state</a>(<a class="code hl_class" href="class_random_c_p_u.html">RandomCPU&lt;num_states&gt;</a>* random) {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        <span class="keywordflow">return</span> random-&gt;<a class="code hl_function" href="class_random_c_p_u.html#aceba08afb7d89984a5d70c559a136b45">get_gaussian_state</a>();</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    }</div>
</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt;</div>
<div class="foldopen" id="foldopen00064" data-start="{" data-end="}">
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno"><a class="line" href="namespace_random.html#a10a6524981427157064c861ec9caeea7">   64</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_random.html#a92140ec7ba37826f5685b5dec6929cf3">set_gaussian_state</a>(<a class="code hl_class" href="class_random_c_p_u.html">RandomCPU&lt;num_states&gt;</a>* random, <span class="keyword">typename</span> <a class="code hl_typedef" href="class_random_c_p_u.html#a07c21897e0ae43da2997906d82f9e3b7">RandomCPU&lt;num_states&gt;::state_t</a>* state) {</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>        random-&gt;<a class="code hl_function" href="class_random_c_p_u.html#a28b81de7eee55eefb706f8635b2e9b37">set_gaussian_state</a>(state);</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    }</div>
</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt;</div>
<div class="foldopen" id="foldopen00069" data-start="{" data-end="}">
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno"><a class="line" href="namespace_random.html#ab976a8ed94a954c995c2e321cbfa9d68">   69</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(<a class="code hl_class" href="class_random_c_p_u.html">RandomCPU&lt;num_states&gt;</a>* random, <span class="keyword">typename</span> <a class="code hl_typedef" href="class_random_c_p_u.html#a07c21897e0ae43da2997906d82f9e3b7">RandomCPU&lt;num_states&gt;::state_t</a>* state) {</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>        <span class="keywordflow">return</span> random-&gt;<a class="code hl_function" href="class_random_c_p_u.html#a24269d8fa85b12780eb1dde7a9baacb9">gaussian</a>(state);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    }</div>
</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    <span class="comment">// Device implementations for RandomGPU</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="preprocessor">    #ifdef USE_CUDA</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keyword">typename</span> RandomGPU&lt;num_states&gt;::state_t* <a class="code hl_function" href="namespace_random.html#a4f13e6f3e1a58cffdfc1a5bfc199066f">get_gaussian_state</a>(RandomGPU&lt;num_states&gt;* random) {</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        <span class="keywordflow">return</span> random-&gt;get_gaussian_state();</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    }</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span> </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_random.html#a92140ec7ba37826f5685b5dec6929cf3">set_gaussian_state</a>(RandomGPU&lt;num_states&gt;* random, <span class="keyword">typename</span> RandomGPU&lt;num_states&gt;::state_t* state) {</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>        random-&gt;set_gaussian_state(state);</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    }</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(RandomGPU&lt;num_states&gt;* random, <span class="keyword">typename</span> RandomGPU&lt;num_states&gt;::state_t* state) {</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        <span class="keywordflow">return</span> random-&gt;gaussian(state);</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    }</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><span class="preprocessor">    #endif</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>} <span class="comment">// namespace Random</span></div>
</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span> </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span><span class="keyword">class </span><a class="code hl_class" href="class_random_c_p_u.html">RandomCPU</a> {</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <span class="keyword">static_assert</span>(num_states &gt; 0);</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno"><a class="line" href="class_random_c_p_u.html#a07c21897e0ae43da2997906d82f9e3b7">   97</a></span>    <span class="keyword">using </span><a class="code hl_typedef" href="class_random_c_p_u.html#a07c21897e0ae43da2997906d82f9e3b7">state_t</a> = curandGenerator_t;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span> </div>
<div class="foldopen" id="foldopen00099" data-start="{" data-end="}">
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno"><a class="line" href="class_random_c_p_u.html#a06f9dbac58a1a8c4f61a2ba5a3aec4e5">   99</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_function" href="class_random_c_p_u.html#a06f9dbac58a1a8c4f61a2ba5a3aec4e5">RandomCPU</a>() : <a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a>{nullptr}, <a class="code hl_variable" href="class_random_c_p_u.html#a5ef75d276ce8fdde1bce17c379319851">buffer_index</a>{2} {</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>        <span class="comment">// Create a pseudo-random number generator</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>        cuRandchk(curandCreateGeneratorHost(&amp;<a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a>, CURAND_RNG_PSEUDO_DEFAULT));</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    }</div>
</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="foldopen" id="foldopen00104" data-start="{" data-end="}">
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="class_random_c_p_u.html#a210542604fda0091962c7f39096b10ae">  104</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_function" href="class_random_c_p_u.html#a210542604fda0091962c7f39096b10ae">~RandomCPU</a>() {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>        <span class="comment">// Destroy the generator</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a>) {</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>            cuRandchk(curandDestroyGenerator(<a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a>));</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>            <a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>        }</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    }</div>
</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="foldopen" id="foldopen00112" data-start="{" data-end="}">
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno"><a class="line" href="class_random_c_p_u.html#ad79ef8418a081201da488407da17ff74">  112</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <span class="keywordtype">void</span> <a class="code hl_function" href="class_random_c_p_u.html#ad79ef8418a081201da488407da17ff74">init</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> seed, <span class="keywordtype">size_t</span> offset = 0) {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>        cuRandchk(curandSetPseudoRandomGeneratorSeed(<a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a>, seed));</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        <span class="comment">// Set the offset if needed</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>        <span class="keywordflow">if</span> (offset &gt; 0) {</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>            cuRandchk(curandSetGeneratorOffset(<a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a>, offset));</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        }</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    }</div>
</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="comment">// Generate a single Gaussian random number</span></div>
<div class="foldopen" id="foldopen00121" data-start="{" data-end="}">
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="class_random_c_p_u.html#addc4f0af09ad8299314e22bdac5d30e6">  121</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <span class="keywordtype">float</span> <a class="code hl_function" href="class_random_c_p_u.html#addc4f0af09ad8299314e22bdac5d30e6">gaussian</a>(<a class="code hl_typedef" href="class_random_c_p_u.html#a07c21897e0ae43da2997906d82f9e3b7">state_t</a>* <a class="code hl_variable" href="class_random_c_p_u.html#ac34eaf03d0c13141b8ad260eddf4472f">state</a> = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_random_c_p_u.html#a5ef75d276ce8fdde1bce17c379319851">buffer_index</a> &gt;= 2) {</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>            <span class="comment">// Buffer is empty, generate new random numbers</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>            cuRandchk(curandGenerateNormal(<a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a>, <a class="code hl_variable" href="class_random_c_p_u.html#aca58d005b90065d65ca512df574ef49e">buffer</a>, 2, 0.0f, 1.0f));</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>            <a class="code hl_variable" href="class_random_c_p_u.html#a5ef75d276ce8fdde1bce17c379319851">buffer_index</a> = 0;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>        }</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>        <span class="comment">// Return the next number from the buffer</span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="class_random_c_p_u.html#aca58d005b90065d65ca512df574ef49e">buffer</a>[<a class="code hl_variable" href="class_random_c_p_u.html#a5ef75d276ce8fdde1bce17c379319851">buffer_index</a>++];</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    }</div>
</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <span class="comment">// Get the current generator state</span></div>
<div class="foldopen" id="foldopen00132" data-start="{" data-end="}">
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno"><a class="line" href="class_random_c_p_u.html#af6755750dbde7f288a3b2ad47ef6066a">  132</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_typedef" href="class_random_c_p_u.html#a07c21897e0ae43da2997906d82f9e3b7">state_t</a>* <a class="code hl_function" href="class_random_c_p_u.html#af6755750dbde7f288a3b2ad47ef6066a">get_gaussian_state</a>() {</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>        <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a>;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    }</div>
</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    <span class="comment">// Set the generator state (not commonly used with cuRAND Host API)</span></div>
<div class="foldopen" id="foldopen00137" data-start="{" data-end="}">
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno"><a class="line" href="class_random_c_p_u.html#abe4f5776ff00e2b9215ec513389a29e0">  137</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <span class="keywordtype">void</span> <a class="code hl_function" href="class_random_c_p_u.html#abe4f5776ff00e2b9215ec513389a29e0">set_gaussian_state</a>(<a class="code hl_typedef" href="class_random_c_p_u.html#a07c21897e0ae43da2997906d82f9e3b7">state_t</a>* <a class="code hl_variable" href="class_random_c_p_u.html#ac34eaf03d0c13141b8ad260eddf4472f">state</a>) {</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_random_c_p_u.html#ac34eaf03d0c13141b8ad260eddf4472f">state</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>            <a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a> = *<a class="code hl_variable" href="class_random_c_p_u.html#ac34eaf03d0c13141b8ad260eddf4472f">state</a>;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        }</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    }</div>
</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <span class="comment">// Generate a 3D vector of Gaussian random numbers</span></div>
<div class="foldopen" id="foldopen00144" data-start="{" data-end="}">
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno"><a class="line" href="class_random_c_p_u.html#a9ba2bb1304e5e7ca116559a606a4142f">  144</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_typedef" href="_types_8h.html#aabb0ec117f70901b8d2288575eba1213">Vector3</a> <a class="code hl_function" href="class_random_c_p_u.html#a9ba2bb1304e5e7ca116559a606a4142f">gaussian_vector</a>(<a class="code hl_typedef" href="class_random_c_p_u.html#a07c21897e0ae43da2997906d82f9e3b7">state_t</a>* <a class="code hl_variable" href="class_random_c_p_u.html#ac34eaf03d0c13141b8ad260eddf4472f">state</a> = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>        <span class="keywordtype">float</span> vals[4]; <span class="comment">// Request 4 numbers to satisfy the multiple of 2 requirement</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>        cuRandchk(curandGenerateNormal(<a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a>, vals, 4, 0.0f, 1.0f));</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        <span class="keywordflow">return</span> <a class="code hl_typedef" href="_types_8h.html#aabb0ec117f70901b8d2288575eba1213">Vector3</a>(vals[0], vals[1], vals[2]);</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    }</div>
</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span> </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno"><a class="line" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">  151</a></span>    <a class="code hl_typedef" href="class_random_c_p_u.html#a07c21897e0ae43da2997906d82f9e3b7">state_t</a> <a class="code hl_variable" href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">generator</a>;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno"><a class="line" href="class_random_c_p_u.html#aca58d005b90065d65ca512df574ef49e">  152</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="class_random_c_p_u.html#aca58d005b90065d65ca512df574ef49e">buffer</a>[2]; <span class="comment">// Buffer to store extra random numbers</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno"><a class="line" href="class_random_c_p_u.html#a5ef75d276ce8fdde1bce17c379319851">  153</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="class_random_c_p_u.html#a5ef75d276ce8fdde1bce17c379319851">buffer_index</a>; <span class="comment">// Index to track usage</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>};</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="foldopen" id="foldopen00156" data-start="{" data-end="};">
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno"><a class="line" href="class_random_c_p_u_old.html">  156</a></span><span class="keyword">class </span><a class="code hl_class" href="class_random_c_p_u_old.html">RandomCPUOld</a> {</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno"><a class="line" href="class_random_c_p_u_old.html#ad40996c182cdd685eb1f651831e72d94">  158</a></span>    <span class="keyword">using </span><a class="code hl_typedef" href="class_random_c_p_u_old.html#ad40996c182cdd685eb1f651831e72d94">state_t</a> = void;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span> </div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    <span class="comment">// Methods for maninpulating the state</span></div>
<div class="foldopen" id="foldopen00161" data-start="{" data-end="}">
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno"><a class="line" href="class_random_c_p_u_old.html#a5f51defa8b39c8d046b627e44802e6d9">  161</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="class_random_c_p_u_old.html#a5f51defa8b39c8d046b627e44802e6d9">init</a>(<span class="keywordtype">size_t</span> num, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> seed, <span class="keywordtype">size_t</span> offset) {</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <span class="comment">// </span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    };</div>
</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <span class="comment">// Methods for generating random values</span></div>
<div class="foldopen" id="foldopen00166" data-start="{" data-end="}">
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno"><a class="line" href="class_random_c_p_u_old.html#ae511b3cdb2acda32cf63eb80984fe668">  166</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="class_random_c_p_u_old.html#ae511b3cdb2acda32cf63eb80984fe668">gaussian</a>(<a class="code hl_typedef" href="class_random_c_p_u_old.html#ad40996c182cdd685eb1f651831e72d94">state_t</a>* state) {</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <a class="code hl_define" href="_signal_manager_8h.html#a4ee40d887237a6594d0d643f6c6b9fa3">LOGWARN</a>(<span class="stringliteral">&quot;RandomCPU::gaussian(): not implemented&quot;</span>);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    };</div>
</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno"><a class="line" href="class_random_c_p_u_old.html#a0ece12ee1b03c5398a9e827cb2420e51">  171</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <a class="code hl_typedef" href="class_random_c_p_u_old.html#ad40996c182cdd685eb1f651831e72d94">state_t</a>* <a class="code hl_function" href="class_random_c_p_u_old.html#a0ece12ee1b03c5398a9e827cb2420e51">get_gaussian_state</a>() { <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; };</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno"><a class="line" href="class_random_c_p_u_old.html#a5f69a75f7b414346a03c78bd8125c32b">  173</a></span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="class_random_c_p_u_old.html#a5f69a75f7b414346a03c78bd8125c32b">set_gaussian_state</a>(<a class="code hl_typedef" href="class_random_c_p_u_old.html#ad40996c182cdd685eb1f651831e72d94">state_t</a>* state) {};</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    <span class="comment">// // HOST DEVICE inline float gaussian(RandomState* state) {};</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <span class="comment">// HOST inline Vector3 gaussian_vector(size_t idx, size_t thread) {</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    <span class="comment">//  return Vector3();</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    <span class="comment">// };</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <span class="comment">// unsigned int integer() {</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    <span class="comment">//  return 0;</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <span class="comment">// };</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <span class="comment">// unsigned int poisson(float lambda) {</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    <span class="comment">//  return 0;</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <span class="comment">// };</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="comment">// float uniform() {</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="comment">//  return 0;</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="comment">// };</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="comment">// void reorder(int *a, int n);</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>};</div>
</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span><span class="comment">// Forward declarations for RandomGPU&lt;&gt;</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span><span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt; <span class="keyword">class </span>RandomGPU_template; <span class="comment">// This templated version wouldn&#39;t allow us to use std::variant to provide a nice uniform host/Python interface regardless of RNG backend. We leave it here anyway to test performance</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span><span class="comment">// template&lt;size_t num_states&gt;</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="comment">// __global__ void RandomGPU_template__test_kernel(RandomGPU_template&lt;num_states&gt;* rng, size_t num_vals, float* buf, unsigned long seed, size_t offset);</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span><span class="comment">//class RandomGPU;</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> RNG&gt;</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>__global__ <span class="keywordtype">void</span> RandomGPU__test_kernel(RNG* rng, <span class="keywordtype">size_t</span> num_vals, <span class="keywordtype">float</span>* buf, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> seed, <span class="keywordtype">size_t</span> offset=0);</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span><span class="comment">// Forward declarations</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span><span class="comment">//</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span><span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt;</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>__global__ <span class="keywordtype">void</span> RandomGPU__test_kernel(RandomGPU&lt;num_states&gt;* rng, <span class="keywordtype">size_t</span> num_vals, <span class="keywordtype">float</span>* buf, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> seed, <span class="keywordtype">size_t</span> offset);</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span> </div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span><span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states&gt;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span><span class="keyword">class </span>RandomGPU {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    <span class="keyword">static_assert</span>(num_states &gt; 0);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <span class="keyword">using </span>state_t = curandStateXORWOW_t;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    <span class="comment">// DEVICE RandomGPU_template(Random::Conf c, Resource&amp; location) : num_states{c.num_threads}, states{nullptr} {</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> RandomGPU_template() : states{nullptr} {</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <span class="comment">// Not sure how this</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    assert( threadIdx.x + blockIdx.x == 0 );</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <a class="code hl_define" href="_signal_manager_8h.html#ac039567033dba8509501b64e55ec2de3">LOGINFO</a>(<span class="stringliteral">&quot;Creating RandomGPU_template&quot;</span>);</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>    <span class="comment">// assert( location.type == Resource::GPU );</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    states = <span class="keyword">new</span> state_t[num_states];</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    }</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> ~RandomGPU_template() {</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <a class="code hl_define" href="_signal_manager_8h.html#ac039567033dba8509501b64e55ec2de3">LOGINFO</a>(<span class="stringliteral">&quot;Destroying RandomGPU_template&quot;</span>);</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    assert( threadIdx.x + blockIdx.x == 0 );</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <span class="keywordflow">if</span> (states != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> [] states;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    states = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    }</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <span class="keyword">static</span> RandomGPU_template&lt;num_states&gt;* instantiate_on_GPU(RandomGPU_template&lt;num_states&gt; *dest = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    <span class="keyword">using </span>RNG = RandomGPU_template&lt;num_states&gt;;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    RNG* rng = <span class="keyword">reinterpret_cast&lt;</span>RNG*<span class="keyword">&gt;</span>(<span class="keyword">new</span> <span class="keywordtype">char</span>[<span class="keyword">sizeof</span>(RNG)]); <span class="comment">// avoid calling constructor</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <span class="keywordflow">if</span> (dest == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        gpuErrchk(cudaMalloc((<span class="keywordtype">void</span>**)&amp;dest, <span class="keyword">sizeof</span>(RNG)));</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    }</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    gpuErrchk(cudaMalloc((<span class="keywordtype">void</span>**)&amp;(rng-&gt;states), <span class="keyword">sizeof</span>(state_t)*num_states));</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    gpuErrchk(cudaMemcpy(dest, rng, <span class="keyword">sizeof</span>(RNG),cudaMemcpyHostToDevice));</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    rng-&gt;states = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <span class="comment">// We avoided constructer, so don&#39;t call `delete rng;`</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="keywordflow">return</span> dest;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>   }</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    </div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(state_t* state) {</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span><span class="preprocessor">#ifdef __CUDA_ARCH__    </span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <span class="keywordflow">return</span> curand_normal( state );</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <a class="code hl_define" href="_signal_manager_8h.html#a4ee40d887237a6594d0d643f6c6b9fa3">LOGWARN</a>(<span class="stringliteral">&quot;RandomGPU_template::gaussian(): not implemented on host&quot;</span>);  </div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    };</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    <span class="comment">// Useful for getting the RNG state for the thread from global</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    <span class="comment">// memory, putting it in local memory for use</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> state_t* <a class="code hl_function" href="namespace_random.html#a4f13e6f3e1a58cffdfc1a5bfc199066f">get_gaussian_state</a>() {</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="preprocessor">#ifdef __CUDA_ARCH__    </span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span>&amp; i = threadIdx.x + blockDim.x*blockIdx.x;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    <span class="keywordflow">return</span> (i &lt; num_states &amp;&amp; states != <span class="keyword">nullptr</span>) ? &amp;(states[i]) : nullptr;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <span class="keywordflow">return</span> (state_t*) <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    };</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_random.html#a92140ec7ba37826f5685b5dec6929cf3">set_gaussian_state</a>(state_t* state) {</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span><span class="preprocessor">#ifdef __CUDA_ARCH__    </span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span>&amp; i = threadIdx.x + blockDim.x*blockIdx.x;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="keywordflow">if</span> (i &lt; num_states &amp;&amp; state != <span class="keyword">nullptr</span>) states[i] = *state;</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    };</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <a class="code hl_typedef" href="_types_8h.html#aabb0ec117f70901b8d2288575eba1213">Vector3</a> gaussian_vector( state_t* state) {</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    <span class="keywordflow">return</span> <a class="code hl_typedef" href="_types_8h.html#aabb0ec117f70901b8d2288575eba1213">Vector3</a>( <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(state), <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(state), <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(state) );</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    };</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span> </div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> kernel_threads = 64&gt; </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="keyword">static</span> <span class="keywordtype">void</span> launch_test_kernel(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> seed, <span class="keywordtype">size_t</span> offset = 0, <span class="keywordtype">size_t</span> num_vals = 4*num_states, RandomGPU_template&lt;num_states&gt;* rng = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    <span class="keyword">using </span>RNG = RandomGPU_template&lt;num_states&gt;;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="keyword">static_assert</span>( (num_states &gt;= kernel_threads) );</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <span class="keyword">static_assert</span>( (num_states % kernel_threads) == 0 );</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    <span class="keywordtype">bool</span> rng_was_null = (rng == <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    <span class="keywordflow">if</span> (rng_was_null) rng = RNG::instantiate_on_GPU();</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <span class="keywordtype">float</span> *buf_d, *buf;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span> </div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>    <a class="code hl_define" href="_signal_manager_8h.html#ae6eaf4fe9601f319d6618ab3e2118e9e">LOGTRACE</a>(<span class="stringliteral">&quot;cudaMalloc {}&quot;</span>, num_vals);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    gpuErrchk(cudaMalloc((<span class="keywordtype">void</span>**)&amp;buf_d, num_vals*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)));</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    <a class="code hl_define" href="_signal_manager_8h.html#ae6eaf4fe9601f319d6618ab3e2118e9e">LOGTRACE</a>(<span class="stringliteral">&quot;...launching kernel&quot;</span>);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>    RandomGPU__test_kernel&lt;&lt;&lt;1+(num_states-1)/kernel_threads, kernel_threads&gt;&gt;&gt;(rng, num_vals, buf_d, seed, offset);</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    buf = <span class="keyword">new</span> <span class="keywordtype">float</span>[num_vals];</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    gpuErrchk(cudaDeviceSynchronize());</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    <a class="code hl_define" href="_signal_manager_8h.html#ae6eaf4fe9601f319d6618ab3e2118e9e">LOGTRACE</a>(<span class="stringliteral">&quot;...copying data back&quot;</span>);</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    gpuErrchk(cudaMemcpy(buf, buf_d, num_vals*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),cudaMemcpyDeviceToHost));</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <span class="keywordtype">float</span> sum = 0;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    <span class="keywordtype">float</span> sum2 = 0;</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; num_vals; ++i) {</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        sum += buf[i];</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        sum2 += buf[i]*buf[i];</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    }</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    <a class="code hl_define" href="_signal_manager_8h.html#ac039567033dba8509501b64e55ec2de3">LOGINFO</a>(<span class="stringliteral">&quot;RNG gaussian mean, std, count: {}, {}, {}&quot;</span>, sum/num_vals, sqrt((sum2/num_vals) - sum*sum/(num_vals*num_vals)), num_vals);</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span> </div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <span class="keywordflow">if</span> (rng_was_null) cudaFree( rng );</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    cudaFree( buf_d );</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <span class="keyword">delete</span>[] buf;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    }</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> get_num_states() { <span class="keywordflow">return</span> num_states; };</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    state_t* states;    <span class="comment">// RNG states stored in global memory </span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>};</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span><span class="comment">// template&lt;size_t num_states = 128&gt;</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span><span class="comment">// __global__ void RandomGPU_template__test_kernel(RandomGPU_template&lt;num_states&gt;* rng, size_t num_vals, float* buf, unsigned long seed, size_t offset = 0) {</span></div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span><span class="comment">//     using RNG = RandomGPU_template&lt;num_states&gt;;</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="comment">//     // printf(&quot;THREAD %d\n&quot;, threadIdx.x);</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span><span class="comment">//     auto local_state = Random::get_gaussian_state&lt;RNG&gt;(rng);</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span><span class="comment">//     for (size_t idx = threadIdx.x + blockIdx.x*blockDim.x; idx &lt; num_states; idx += blockDim.x * gridDim.x) {</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span><span class="comment">//  assert(blockIdx.x == 0);</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span><span class="comment">//  // curand_init(unsigned long long seed,</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span><span class="comment">//  //      unsigned long long sequence,</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span><span class="comment">//  //      unsigned long long offset,</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span><span class="comment">//  //      curandStateXORWOW_t *state)</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span><span class="comment">//  curand_init(seed, idx, offset, local_state);</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span><span class="comment">//     }</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span><span class="comment">//     for (size_t idx = threadIdx.x + blockIdx.x*blockDim.x; idx &lt; num_vals; idx += blockDim.x * gridDim.x) {</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span><span class="comment">//  buf[idx] = Random::gaussian&lt;RNG&gt;(rng, local_state);</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span><span class="comment">//     }</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span><span class="comment">//     Random::set_gaussian_state&lt;RNG&gt;(rng, local_state);</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span><span class="comment">// };</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span><span class="keyword">class </span>RandomGPU {</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <span class="keyword">using </span>state_t = curandStateXORWOW_t;</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span> </div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <span class="comment">// DEVICE RandomGPU_template(Random::Conf c, Resource&amp; location) : num_states{c.num_threads}, states{nullptr} {</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span> </div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> RandomGPU(<span class="keywordtype">size_t</span> num_states) : states{nullptr} {</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    assert( num_states &gt; 0 );</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    <span class="comment">// Not sure how this</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    assert( threadIdx.x + blockIdx.x == 0 );</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>    </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>    <a class="code hl_define" href="_signal_manager_8h.html#ac039567033dba8509501b64e55ec2de3">LOGINFO</a>(<span class="stringliteral">&quot;Creating RandomGPU&quot;</span>);</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    <span class="comment">// assert( location.type == Resource::GPU );</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>    states = <span class="keyword">new</span> state_t[num_states];</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    }</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> ~RandomGPU() {</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    <a class="code hl_define" href="_signal_manager_8h.html#ac039567033dba8509501b64e55ec2de3">LOGINFO</a>(<span class="stringliteral">&quot;Destroying RandomGPU&quot;</span>);</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    assert( threadIdx.x + blockIdx.x == 0 );</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    <span class="keywordflow">if</span> (states != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> [] states;</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    states = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    }</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <span class="keyword">static</span> RandomGPU* instantiate_on_GPU(<span class="keywordtype">size_t</span> num_states, RandomGPU *dest = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    <span class="keyword">using </span>RNG = RandomGPU;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    RNG* rng = <span class="keyword">reinterpret_cast&lt;</span>RNG*<span class="keyword">&gt;</span>(<span class="keyword">new</span> <span class="keywordtype">char</span>[<span class="keyword">sizeof</span>(RNG)]); <span class="comment">// avoid calling constructor</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    <span class="keywordflow">if</span> (dest == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>        gpuErrchk(cudaMalloc((<span class="keywordtype">void</span>**)&amp;dest, <span class="keyword">sizeof</span>(RNG)));</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    }</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>    rng-&gt;num_states = num_states;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>    gpuErrchk(cudaMalloc((<span class="keywordtype">void</span>**)&amp;(rng-&gt;states), <span class="keyword">sizeof</span>(state_t)*num_states));</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>    gpuErrchk(cudaMemcpy(dest, rng, <span class="keyword">sizeof</span>(RNG),cudaMemcpyHostToDevice));</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    rng-&gt;states = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    <span class="comment">// We avoided constructer, so don&#39;t call `delete rng;`</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    <span class="keywordflow">return</span> dest;</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    }</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    </div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(state_t* state) {</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span><span class="preprocessor">#ifdef __CUDA_ARCH__    </span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <span class="keywordflow">return</span> curand_normal( state );</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    <a class="code hl_define" href="_signal_manager_8h.html#a4ee40d887237a6594d0d643f6c6b9fa3">LOGWARN</a>(<span class="stringliteral">&quot;RandomGPU::gaussian(): not implemented on host&quot;</span>);   </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    };</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    </div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    <span class="comment">// Useful for getting the RNG state for the thread from global</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    <span class="comment">// memory, putting it in local memory for use</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> state_t* <a class="code hl_function" href="namespace_random.html#a4f13e6f3e1a58cffdfc1a5bfc199066f">get_gaussian_state</a>() {</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span><span class="preprocessor">#ifdef __CUDA_ARCH__    </span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span>&amp; i = threadIdx.x + blockDim.x*blockIdx.x;</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="keywordflow">return</span> (i &lt; num_states &amp;&amp; states != <span class="keyword">nullptr</span>) ? &amp;(states[i]) : nullptr;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    <span class="keywordflow">return</span> (state_t*) <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    };</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_random.html#a92140ec7ba37826f5685b5dec6929cf3">set_gaussian_state</a>(state_t* state) {</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span><span class="preprocessor">#ifdef __CUDA_ARCH__    </span></div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span>&amp; i = threadIdx.x + blockDim.x*blockIdx.x;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    <span class="keywordflow">if</span> (i &lt; num_states &amp;&amp; state != <span class="keyword">nullptr</span>) states[i] = *state;</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    };</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <a class="code hl_typedef" href="_types_8h.html#aabb0ec117f70901b8d2288575eba1213">Vector3</a> gaussian_vector( state_t* state) {</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    <span class="keywordflow">return</span> <a class="code hl_typedef" href="_types_8h.html#aabb0ec117f70901b8d2288575eba1213">Vector3</a>( <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(state), <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(state), <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(state) );</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>    };</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>    <span class="keyword">template</span>&lt;<span class="keywordtype">size_t</span> num_states = 128, <span class="keywordtype">size_t</span> kernel_threads = 64&gt; </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    <span class="keyword">static</span> <span class="keywordtype">void</span> launch_test_kernel(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> seed, <span class="keywordtype">size_t</span> offset = 0, <span class="keywordtype">size_t</span> num_vals = 4*num_states, RandomGPU* rng = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    <span class="keyword">using </span>RNG = RandomGPU;</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    <span class="keyword">static_assert</span>( (num_states &gt;= kernel_threads) );</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    <span class="keyword">static_assert</span>( (num_states % kernel_threads) == 0 );</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>    <span class="keywordtype">bool</span> rng_was_null = (rng == <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    <span class="keywordflow">if</span> (rng_was_null) rng = RNG::instantiate_on_GPU(num_states);</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <span class="keywordtype">float</span> *buf_d, *buf;</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    <a class="code hl_define" href="_signal_manager_8h.html#ae6eaf4fe9601f319d6618ab3e2118e9e">LOGTRACE</a>(<span class="stringliteral">&quot;cudaMalloc {}&quot;</span>, num_vals);</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    gpuErrchk(cudaMalloc((<span class="keywordtype">void</span>**)&amp;buf_d, num_vals*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)));</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    <a class="code hl_define" href="_signal_manager_8h.html#ae6eaf4fe9601f319d6618ab3e2118e9e">LOGTRACE</a>(<span class="stringliteral">&quot;...launching kernel&quot;</span>);</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    RandomGPU__test_kernel&lt;&lt;&lt;1+(num_states-1)/kernel_threads, kernel_threads&gt;&gt;&gt;(rng, num_vals, buf_d, seed, offset);</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    buf = <span class="keyword">new</span> <span class="keywordtype">float</span>[num_vals];</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    gpuErrchk(cudaDeviceSynchronize());</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    <a class="code hl_define" href="_signal_manager_8h.html#ae6eaf4fe9601f319d6618ab3e2118e9e">LOGTRACE</a>(<span class="stringliteral">&quot;...copying data back&quot;</span>);</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    gpuErrchk(cudaMemcpy(buf, buf_d, num_vals*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),cudaMemcpyDeviceToHost));</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    <span class="keywordtype">float</span> sum = 0;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>    <span class="keywordtype">float</span> sum2 = 0;</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; num_vals; ++i) {</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        sum += buf[i];</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>        sum2 += buf[i]*buf[i];</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    }</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    <a class="code hl_define" href="_signal_manager_8h.html#ac039567033dba8509501b64e55ec2de3">LOGINFO</a>(<span class="stringliteral">&quot;RNG gaussian mean, std, count: {}, {}, {}&quot;</span>, sum/num_vals, sqrt((sum2/num_vals) - sum*sum/(num_vals*num_vals)), num_vals);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span> </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    <span class="keywordflow">if</span> (rng_was_null) cudaFree( rng );</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    cudaFree( buf_d );</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    <span class="keyword">delete</span>[] buf;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    };</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keywordtype">size_t</span> get_num_states()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> num_states; };</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    </div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <span class="keywordtype">size_t</span> num_states;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    state_t* states;    <span class="comment">// RNG states stored in global memory </span></div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>};</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> RNG&gt;</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>__global__ <span class="keywordtype">void</span> RandomGPU__test_kernel(RNG* rng, <span class="keywordtype">size_t</span> num_vals, <span class="keywordtype">float</span>* buf, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> seed, <span class="keywordtype">size_t</span> offset) {</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <span class="comment">// printf(&quot;THREAD %d\n&quot;, threadIdx.x);</span></div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> num_states = rng-&gt;get_num_states();</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <span class="keyword">auto</span> local_state = <a class="code hl_function" href="namespace_random.html#a4f13e6f3e1a58cffdfc1a5bfc199066f">Random::get_gaussian_state&lt;RNG&gt;</a>(rng);</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx = threadIdx.x + blockIdx.x*blockDim.x; idx &lt; num_states; idx += blockDim.x * gridDim.x) {</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>    assert(blockIdx.x == 0);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>    <span class="comment">// curand_init(unsigned long long seed,</span></div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    <span class="comment">//      unsigned long long sequence,</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    <span class="comment">//      unsigned long long offset,</span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <span class="comment">//      curandStateXORWOW_t *state)</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    curand_init(seed, idx, offset, local_state);</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    }</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx = threadIdx.x + blockIdx.x*blockDim.x; idx &lt; num_vals; idx += blockDim.x * gridDim.x) {</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    buf[idx] = <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">Random::gaussian&lt;RNG&gt;</a>(rng, local_state);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    }</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <a class="code hl_function" href="namespace_random.html#a92140ec7ba37826f5685b5dec6929cf3">Random::set_gaussian_state&lt;RNG&gt;</a>(rng, local_state);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>};</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span><span class="keyword">class </span>RandomAcc {</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>    <span class="keyword">using </span>state_t = void;</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>   </div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    <span class="comment">// Methods for maninpulating the state</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    <span class="keywordtype">void</span> init(<span class="keywordtype">size_t</span> num, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> seed, <span class="keywordtype">size_t</span> offset) {</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    </div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>    };</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span> </div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    <span class="comment">// Methods for generating random values</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <span class="comment">// template&lt;typename S&gt;</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(state_t* state) {</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    <a class="code hl_define" href="_signal_manager_8h.html#a4ee40d887237a6594d0d643f6c6b9fa3">LOGWARN</a>(<span class="stringliteral">&quot;RandomAcc::gaussian(): not implemented&quot;</span>);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    };</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>    <span class="comment">// template&lt;typename S&gt;</span></div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> state_t* <a class="code hl_function" href="namespace_random.html#a4f13e6f3e1a58cffdfc1a5bfc199066f">get_gaussian_state</a>() { <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; };</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span> </div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>    <a class="code hl_define" href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a> <a class="code hl_define" href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespace_random.html#a92140ec7ba37826f5685b5dec6929cf3">set_gaussian_state</a>(state_t* state) {};</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span> </div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    </div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    <span class="comment">// // HOST DEVICE inline float gaussian(RandomState* state) {};</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    <span class="comment">// HOST inline Vector3 gaussian_vector(size_t idx, size_t thread) {</span></div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>    <span class="comment">//  return Vector3();</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>    <span class="comment">// };</span></div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    <span class="comment">// unsigned int integer() {</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>    <span class="comment">//  return 0;</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    <span class="comment">// };</span></div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    <span class="comment">// unsigned int poisson(float lambda) {</span></div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    <span class="comment">//  return 0;</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    <span class="comment">// };</span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    <span class="comment">// float uniform() {</span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    <span class="comment">//  return 0;</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    <span class="comment">// };</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>    <span class="comment">// void reorder(int *a, int n);</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>};</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span> </div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span><span class="comment">// class RandomTest {</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span><span class="comment">//     static constexpr bool no_send = true;</span></div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span><span class="comment">//     using RNGp = std::variant&lt;RandomAcc*, RandomCPU*&gt;;</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span><span class="comment">//     RNGp rng;        // could be host or device</span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span> </div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span><span class="comment">//     template&lt;typename T&gt;</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span><span class="comment">//     auto set( T ptr ) {</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span><span class="comment">//  rng = ptr;</span></div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span><span class="comment">//     };</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span><span class="comment">//         // Example function to get Gaussian state (optional)</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span><span class="comment">//     template &lt;typename T&gt;</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span><span class="comment">//     auto get_gaussian_state() {</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span><span class="comment">//         // if (auto ptr = std::get_if&lt;T*&gt;(rng)) {</span></div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span><span class="comment">//         //     return (*ptr)-&gt;get_gaussian_state();</span></div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span><span class="comment">//         // }</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span><span class="comment">//         // throw std::runtime_error(&quot;Requested type not currently held in variant.&quot;);</span></div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span><span class="comment">//         // if (auto ptr = std::get_if&lt;std::shared_ptr&lt;T&gt;&gt;(&amp;rng)) {</span></div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span><span class="comment">//  return std::get&lt;T&gt;(&amp;rng)-&gt;get_gaussian_state();</span></div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span><span class="comment">//      //}</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span><span class="comment">//      // throw std::runtime_error(&quot;Requested type not currently held in variant.&quot;);</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span><span class="comment">//     }    </span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span><span class="comment">// };</span></div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span> </div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span><span class="keyword">class </span>RandomI {</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span> </div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> no_send = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    <span class="keywordtype">float</span> <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>() { <span class="keywordflow">return</span> rng.gaussian(); }</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span> </div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    std::any <a class="code hl_function" href="namespace_random.html#a4f13e6f3e1a58cffdfc1a5bfc199066f">get_gaussian_state</a>() {</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>    <span class="keywordflow">return</span> std::visit([<span class="keyword">this</span>](<span class="keyword">auto</span>&amp;&amp; ptr) -&gt; std::any {</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        <span class="keyword">using </span>PtrType = std::decay_t&lt;<span class="keyword">decltype</span>(ptr)&gt;;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;PtrType, RandomAcc*&gt; || std::is_same_v&lt;PtrType, RandomCPU*&gt;) {</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>            <span class="keywordflow">if</span> (ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>                <span class="keywordflow">return</span> ptr-&gt;get_gaussian_state();</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>            }</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>        }</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Invalid or nullptr variant state.&quot;</span>);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    }, rng);</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>    }</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span> </div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>    <span class="keywordtype">float</span> <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>() {</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    <span class="keywordflow">return</span> std::visit([<span class="keyword">this</span>](<span class="keyword">auto</span>&amp;&amp; ptr) -&gt; <span class="keywordtype">float</span> {</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        <span class="keyword">using </span>PtrType = std::decay_t&lt;<span class="keyword">decltype</span>(ptr)&gt;;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;PtrType, RandomAcc*&gt; || std::is_same_v&lt;PtrType, RandomCPU*&gt;) {</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>            <span class="keywordflow">if</span> (ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>                <span class="keywordflow">return</span> ptr-&gt;gaussian(ptr-&gt;get_gaussian_state());</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>            }</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>        }</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Invalid or nullptr variant state.&quot;</span>);</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    }, rng);</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>    }</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>    </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>    <span class="keywordtype">float</span> <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(std::any state) {</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>    <span class="keywordflow">if</span> (std::holds_alternative&lt;RandomAcc*&gt;(rng)) {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>        <span class="keywordflow">return</span> _gaussian_helper&lt;RandomAcc&gt;(state);</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::holds_alternative&lt;RandomCPU*&gt;(rng)) {</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>        <span class="keywordflow">return</span> _gaussian_helper&lt;RandomCPU&gt;(state);</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Requested type not currently held in variant.&quot;</span>);</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>    }</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    }</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>    std::any _get_gaussian_state_helper() {</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    <span class="keyword">auto</span> ptr = std::get&lt;T*&gt;(rng);</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>        <span class="keywordflow">if</span> (ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>            <span class="keyword">auto</span> state = ptr-&gt;get_gaussian_state();</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        <span class="keywordflow">return</span> std::any(state);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempted to obtain RNG state from uninitialized Random interface.&quot;</span>);</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    }</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    }</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>    <span class="keywordtype">float</span> _gaussian_helper(std::any state) {</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>    <span class="keyword">auto</span> ptr = std::get&lt;T*&gt;(rng);</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        <span class="keywordflow">if</span> (ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>            <span class="keywordflow">return</span> ptr-&gt;gaussian(std::any_cast&lt;typename T::state_t*&gt;(state));</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempted to obtain gaussian from uninitialized Random interface.&quot;</span>);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>    }</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    }</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span> </div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>    RNG* rng;       <span class="comment">// could be stored on host or device</span></div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>};</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span> </div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span> </div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span><span class="keyword">class </span>RandomTest1 {</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> no_send = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>    <span class="keyword">using </span>RNGp = std::variant&lt;RandomAcc*, RandomCPU*&gt;;</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span> </div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    <span class="keyword">auto</span> set( T* ptr ) { rng = ptr; };</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span> </div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>    std::any <a class="code hl_function" href="namespace_random.html#a4f13e6f3e1a58cffdfc1a5bfc199066f">get_gaussian_state</a>() {</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>    <span class="comment">// if (std::holds_alternative&lt;RandomAcc*&gt;(rng)) {</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>    <span class="comment">//     return _get_gaussian_state_helper&lt;RandomAcc&gt;();</span></div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>    <span class="comment">// } else if (std::holds_alternative&lt;RandomCPU*&gt;(rng)) {</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    <span class="comment">//     return _get_gaussian_state_helper&lt;RandomCPU&gt;();</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>    <span class="comment">// } else {</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>    <span class="comment">//     throw std::runtime_error(&quot;Requested type not currently held in variant.&quot;);</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    <span class="comment">// }</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>    <span class="keywordflow">return</span> std::visit([<span class="keyword">this</span>](<span class="keyword">auto</span>&amp;&amp; ptr) -&gt; std::any {</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>        <span class="keyword">using </span>PtrType = std::decay_t&lt;<span class="keyword">decltype</span>(ptr)&gt;;</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (std::is_same_v&lt;PtrType, RandomAcc*&gt; || std::is_same_v&lt;PtrType, RandomCPU*&gt;) {</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>            <span class="keywordflow">if</span> (ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>                <span class="keywordflow">return</span> ptr-&gt;get_gaussian_state();</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>            }</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>        }</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Invalid or nullptr variant state.&quot;</span>);</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    }, rng);</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>    }</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>    <span class="keywordtype">float</span> <a class="code hl_function" href="namespace_random.html#a712c66e975715a7e881e12203179b71f">gaussian</a>(std::any state) {</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    <span class="keywordflow">if</span> (std::holds_alternative&lt;RandomAcc*&gt;(rng)) {</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>        <span class="keywordflow">return</span> _gaussian_helper&lt;RandomAcc&gt;(state);</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::holds_alternative&lt;RandomCPU*&gt;(rng)) {</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>        <span class="keywordflow">return</span> _gaussian_helper&lt;RandomCPU&gt;(state);</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Requested type not currently held in variant.&quot;</span>);</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    }</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>    }</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>    std::any _get_gaussian_state_helper() {</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    <span class="keyword">auto</span> ptr = std::get&lt;T*&gt;(rng);</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>        <span class="keywordflow">if</span> (ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>            <span class="keyword">auto</span> state = ptr-&gt;get_gaussian_state();</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>        <span class="keywordflow">return</span> std::any(state);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempted to obtain RNG state from uninitialized Random interface.&quot;</span>);</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    }</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>    }</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>    <span class="keywordtype">float</span> _gaussian_helper(std::any state) {</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    <span class="keyword">auto</span> ptr = std::get&lt;T*&gt;(rng);</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>        <span class="keywordflow">if</span> (ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>            <span class="keywordflow">return</span> ptr-&gt;gaussian(std::any_cast&lt;typename T::state_t*&gt;(state));</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Attempted to obtain gaussian from uninitialized Random interface.&quot;</span>);</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    }</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>    }</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span> </div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>    RNGp rng;       <span class="comment">// could be stored on host or device</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>};</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span><span class="comment">// class RandomTest {</span></div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span><span class="comment">//     static constexpr bool no_send = true;</span></div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span><span class="comment">//     using RNGp = std::variant&lt;std::weak_ptr&lt;RandomAcc&gt;, std::weak_ptr&lt;RandomCPU&gt;&gt;;</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span><span class="comment">//     RNGp rng;        // could be host or device</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span> </div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span><span class="comment">//     template&lt;typename T&gt;</span></div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span><span class="comment">//     auto set( T* ptr ) { rng = std::weak_ptr&lt;T&gt;(ptr); };</span></div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span><span class="comment">//         // Example function to get Gaussian state (optional)</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span><span class="comment">//     template &lt;typename T&gt;</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span><span class="comment">//     auto get_gaussian_state() {</span></div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span><span class="comment">//         if (auto ptr = std::get_if&lt;std::weak_ptr&lt;T&gt;&gt;(&amp;rng)) {</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span><span class="comment">//             return (*ptr)-&gt;get_gaussian_state();</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span><span class="comment">//         }</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span><span class="comment">//         throw std::runtime_error(&quot;Requested type not currently held in variant.&quot;);</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span><span class="comment">//     }</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span> </div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span><span class="comment">//     template &lt;typename T&gt;</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span><span class="comment">//     auto gaussian() {</span></div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span><span class="comment">//         if (auto ptr = std::get_if&lt;std::weak_ptr&lt;T&gt;&gt;(&amp;rng)) {</span></div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span><span class="comment">//             return (*ptr)-&gt;gaussian();</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span><span class="comment">//         }</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span><span class="comment">//         throw std::runtime_error(&quot;Requested type not currently held in variant.&quot;);</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span><span class="comment">//     }</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    </div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span><span class="comment">// };</span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span> </div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>    <span class="comment">// template&lt;typename T&gt;</span></div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>    <span class="comment">// inline typename T::state_t* get_gaussian_state() {</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>    <span class="comment">//  return std::get&lt;std::shared_ptr&lt;T&gt;&gt; rng-&gt;get_gaussian_state();</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>    <span class="comment">// }</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span> </div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>   <span class="comment">// auto get_gaussian_state() {</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>   <span class="comment">//      return visit_rng([](auto&amp;&amp; ptr) {</span></div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>   <span class="comment">//          using T = std::decay_t&lt;decltype(ptr)&gt;;</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>   <span class="comment">//          return ptr-&gt;get_gaussian_state(); // Access the method based on the type</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>   <span class="comment">//      });</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>   <span class="comment">//  }</span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span> </div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span><span class="comment">//    static constexpr bool no_send = true;</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span> <span class="comment">// Should cause compilation error or runtime issues! We won&#39;t know the type of hte state in the backend. What are some ways around this?</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>    <span class="comment">// one approach might be to make the result depend on</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span> </div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span> </div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>    <span class="comment">// inline auto set_gaussian_state() {</span></div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>    <span class="comment">//  return rng-&gt;set_gaussian_state();</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    <span class="comment">// }</span></div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    <span class="comment">// location? other stuff?</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span> </div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span> </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="a_g_p_u_manager_8h_html"><div class="ttname"><a href="_g_p_u_manager_8h.html">GPUManager.h</a></div></div>
<div class="ttc" id="a_g_p_u_manager_8h_html_a775d096fbc3988fb7ed858b79ef44e22"><div class="ttname"><a href="_g_p_u_manager_8h.html#a775d096fbc3988fb7ed858b79ef44e22">DEVICE</a></div><div class="ttdeci">#define DEVICE</div><div class="ttdef"><b>Definition</b> <a href="_g_p_u_manager_8h_source.html#l00010">GPUManager.h:10</a></div></div>
<div class="ttc" id="a_g_p_u_manager_8h_html_abbbcf3c42c997889127cc676754a6fea"><div class="ttname"><a href="_g_p_u_manager_8h.html#abbbcf3c42c997889127cc676754a6fea">HOST</a></div><div class="ttdeci">#define HOST</div><div class="ttdef"><b>Definition</b> <a href="_g_p_u_manager_8h_source.html#l00009">GPUManager.h:9</a></div></div>
<div class="ttc" id="a_proxy_8h_html"><div class="ttname"><a href="_proxy_8h.html">Proxy.h</a></div></div>
<div class="ttc" id="a_signal_manager_8h_html_a4ee40d887237a6594d0d643f6c6b9fa3"><div class="ttname"><a href="_signal_manager_8h.html#a4ee40d887237a6594d0d643f6c6b9fa3">LOGWARN</a></div><div class="ttdeci">#define LOGWARN(...)</div><div class="ttdef"><b>Definition</b> <a href="_signal_manager_8h_source.html#l00066">SignalManager.h:66</a></div></div>
<div class="ttc" id="a_signal_manager_8h_html_ac039567033dba8509501b64e55ec2de3"><div class="ttname"><a href="_signal_manager_8h.html#ac039567033dba8509501b64e55ec2de3">LOGINFO</a></div><div class="ttdeci">#define LOGINFO(...)</div><div class="ttdef"><b>Definition</b> <a href="_signal_manager_8h_source.html#l00065">SignalManager.h:65</a></div></div>
<div class="ttc" id="a_signal_manager_8h_html_ae6eaf4fe9601f319d6618ab3e2118e9e"><div class="ttname"><a href="_signal_manager_8h.html#ae6eaf4fe9601f319d6618ab3e2118e9e">LOGTRACE</a></div><div class="ttdeci">#define LOGTRACE(...)</div><div class="ttdef"><b>Definition</b> <a href="_signal_manager_8h_source.html#l00063">SignalManager.h:63</a></div></div>
<div class="ttc" id="a_types_8h_html"><div class="ttname"><a href="_types_8h.html">Types.h</a></div></div>
<div class="ttc" id="a_types_8h_html_aabb0ec117f70901b8d2288575eba1213"><div class="ttname"><a href="_types_8h.html#aabb0ec117f70901b8d2288575eba1213">Vector3</a></div><div class="ttdeci">Vector3_t&lt; float &gt; Vector3</div><div class="ttdef"><b>Definition</b> <a href="_types_8h_source.html#l00035">Types.h:35</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html"><div class="ttname"><a href="class_random_c_p_u.html">RandomCPU</a></div><div class="ttdef"><b>Definition</b> <a href="_random_8h_source.html#l00016">Random.h:16</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_a06f9dbac58a1a8c4f61a2ba5a3aec4e5"><div class="ttname"><a href="class_random_c_p_u.html#a06f9dbac58a1a8c4f61a2ba5a3aec4e5">RandomCPU::RandomCPU</a></div><div class="ttdeci">HOST RandomCPU()</div><div class="ttdef"><b>Definition</b> <a href="#l00099">Random_old.h:99</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_a07c21897e0ae43da2997906d82f9e3b7"><div class="ttname"><a href="class_random_c_p_u.html#a07c21897e0ae43da2997906d82f9e3b7">RandomCPU::state_t</a></div><div class="ttdeci">curandGenerator_t state_t</div><div class="ttdef"><b>Definition</b> <a href="#l00097">Random_old.h:97</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_a210542604fda0091962c7f39096b10ae"><div class="ttname"><a href="class_random_c_p_u.html#a210542604fda0091962c7f39096b10ae">RandomCPU::~RandomCPU</a></div><div class="ttdeci">HOST ~RandomCPU()</div><div class="ttdef"><b>Definition</b> <a href="#l00104">Random_old.h:104</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_a24269d8fa85b12780eb1dde7a9baacb9"><div class="ttname"><a href="class_random_c_p_u.html#a24269d8fa85b12780eb1dde7a9baacb9">RandomCPU::gaussian</a></div><div class="ttdeci">float gaussian(state_type *external_state=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="_random_8h_source.html#l00041">Random.h:41</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_a28b81de7eee55eefb706f8635b2e9b37"><div class="ttname"><a href="class_random_c_p_u.html#a28b81de7eee55eefb706f8635b2e9b37">RandomCPU::set_gaussian_state</a></div><div class="ttdeci">void set_gaussian_state(state_type *new_state)</div><div class="ttdef"><b>Definition</b> <a href="_random_8h_source.html#l00050">Random.h:50</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_a5ef75d276ce8fdde1bce17c379319851"><div class="ttname"><a href="class_random_c_p_u.html#a5ef75d276ce8fdde1bce17c379319851">RandomCPU::buffer_index</a></div><div class="ttdeci">int buffer_index</div><div class="ttdef"><b>Definition</b> <a href="#l00153">Random_old.h:153</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_a9ba2bb1304e5e7ca116559a606a4142f"><div class="ttname"><a href="class_random_c_p_u.html#a9ba2bb1304e5e7ca116559a606a4142f">RandomCPU::gaussian_vector</a></div><div class="ttdeci">HOST Vector3 gaussian_vector(state_t *state=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="#l00144">Random_old.h:144</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_abe4f5776ff00e2b9215ec513389a29e0"><div class="ttname"><a href="class_random_c_p_u.html#abe4f5776ff00e2b9215ec513389a29e0">RandomCPU::set_gaussian_state</a></div><div class="ttdeci">HOST void set_gaussian_state(state_t *state)</div><div class="ttdef"><b>Definition</b> <a href="#l00137">Random_old.h:137</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_ac34eaf03d0c13141b8ad260eddf4472f"><div class="ttname"><a href="class_random_c_p_u.html#ac34eaf03d0c13141b8ad260eddf4472f">RandomCPU::state</a></div><div class="ttdeci">std::unique_ptr&lt; State &gt; state</div><div class="ttdef"><b>Definition</b> <a href="_random_8h_source.html#l00063">Random.h:63</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_aca58d005b90065d65ca512df574ef49e"><div class="ttname"><a href="class_random_c_p_u.html#aca58d005b90065d65ca512df574ef49e">RandomCPU::buffer</a></div><div class="ttdeci">float buffer[2]</div><div class="ttdef"><b>Definition</b> <a href="#l00152">Random_old.h:152</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_aceba08afb7d89984a5d70c559a136b45"><div class="ttname"><a href="class_random_c_p_u.html#aceba08afb7d89984a5d70c559a136b45">RandomCPU::get_gaussian_state</a></div><div class="ttdeci">state_type * get_gaussian_state()</div><div class="ttdef"><b>Definition</b> <a href="_random_8h_source.html#l00046">Random.h:46</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_ad79ef8418a081201da488407da17ff74"><div class="ttname"><a href="class_random_c_p_u.html#ad79ef8418a081201da488407da17ff74">RandomCPU::init</a></div><div class="ttdeci">HOST void init(unsigned long seed, size_t offset=0)</div><div class="ttdef"><b>Definition</b> <a href="#l00112">Random_old.h:112</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_addc4f0af09ad8299314e22bdac5d30e6"><div class="ttname"><a href="class_random_c_p_u.html#addc4f0af09ad8299314e22bdac5d30e6">RandomCPU::gaussian</a></div><div class="ttdeci">HOST float gaussian(state_t *state=nullptr)</div><div class="ttdef"><b>Definition</b> <a href="#l00121">Random_old.h:121</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_adfb24dc38ef9839c830d8f2a255bacdf"><div class="ttname"><a href="class_random_c_p_u.html#adfb24dc38ef9839c830d8f2a255bacdf">RandomCPU::generator</a></div><div class="ttdeci">state_t generator</div><div class="ttdef"><b>Definition</b> <a href="#l00151">Random_old.h:151</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_html_af6755750dbde7f288a3b2ad47ef6066a"><div class="ttname"><a href="class_random_c_p_u.html#af6755750dbde7f288a3b2ad47ef6066a">RandomCPU::get_gaussian_state</a></div><div class="ttdeci">HOST state_t * get_gaussian_state()</div><div class="ttdef"><b>Definition</b> <a href="#l00132">Random_old.h:132</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_old_html"><div class="ttname"><a href="class_random_c_p_u_old.html">RandomCPUOld</a></div><div class="ttdef"><b>Definition</b> <a href="#l00156">Random_old.h:156</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_old_html_a0ece12ee1b03c5398a9e827cb2420e51"><div class="ttname"><a href="class_random_c_p_u_old.html#a0ece12ee1b03c5398a9e827cb2420e51">RandomCPUOld::get_gaussian_state</a></div><div class="ttdeci">HOST DEVICE state_t * get_gaussian_state()</div><div class="ttdef"><b>Definition</b> <a href="#l00171">Random_old.h:171</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_old_html_a5f51defa8b39c8d046b627e44802e6d9"><div class="ttname"><a href="class_random_c_p_u_old.html#a5f51defa8b39c8d046b627e44802e6d9">RandomCPUOld::init</a></div><div class="ttdeci">void init(size_t num, unsigned long seed, size_t offset)</div><div class="ttdef"><b>Definition</b> <a href="#l00161">Random_old.h:161</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_old_html_a5f69a75f7b414346a03c78bd8125c32b"><div class="ttname"><a href="class_random_c_p_u_old.html#a5f69a75f7b414346a03c78bd8125c32b">RandomCPUOld::set_gaussian_state</a></div><div class="ttdeci">HOST DEVICE void set_gaussian_state(state_t *state)</div><div class="ttdef"><b>Definition</b> <a href="#l00173">Random_old.h:173</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_old_html_ad40996c182cdd685eb1f651831e72d94"><div class="ttname"><a href="class_random_c_p_u_old.html#ad40996c182cdd685eb1f651831e72d94">RandomCPUOld::state_t</a></div><div class="ttdeci">void state_t</div><div class="ttdef"><b>Definition</b> <a href="#l00158">Random_old.h:158</a></div></div>
<div class="ttc" id="aclass_random_c_p_u_old_html_ae511b3cdb2acda32cf63eb80984fe668"><div class="ttname"><a href="class_random_c_p_u_old.html#ae511b3cdb2acda32cf63eb80984fe668">RandomCPUOld::gaussian</a></div><div class="ttdeci">HOST DEVICE float gaussian(state_t *state)</div><div class="ttdef"><b>Definition</b> <a href="#l00166">Random_old.h:166</a></div></div>
<div class="ttc" id="anamespace_random_html"><div class="ttname"><a href="namespace_random.html">Random</a></div><div class="ttdef"><b>Definition</b> <a href="#l00045">Random_old.h:45</a></div></div>
<div class="ttc" id="anamespace_random_html_a4f13e6f3e1a58cffdfc1a5bfc199066f"><div class="ttname"><a href="namespace_random.html#a4f13e6f3e1a58cffdfc1a5bfc199066f">Random::get_gaussian_state</a></div><div class="ttdeci">HOST DEVICE RNG::state_t * get_gaussian_state(RNG *random)</div></div>
<div class="ttc" id="anamespace_random_html_a712c66e975715a7e881e12203179b71f"><div class="ttname"><a href="namespace_random.html#a712c66e975715a7e881e12203179b71f">Random::gaussian</a></div><div class="ttdeci">HOST DEVICE float gaussian(RNG *random, typename RNG::state_t *state=nullptr)</div></div>
<div class="ttc" id="anamespace_random_html_a92140ec7ba37826f5685b5dec6929cf3"><div class="ttname"><a href="namespace_random.html#a92140ec7ba37826f5685b5dec6929cf3">Random::set_gaussian_state</a></div><div class="ttdeci">HOST DEVICE void set_gaussian_state(RNG *random, typename RNG::state_t *state)</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_random__old_8h.html">Random_old.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
